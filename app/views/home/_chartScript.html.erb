<script type="text/javascript">
	$(function () {
		var chart = new Highcharts.Chart({
		chart: {
			renderTo: 'chart',
			type: 'line',
			fontSize:'100%'
		},
		title: {
			text: '<%= @team1name.first.gsub('"','') %> vs <%= @team2name.first.gsub('"','') %>',
			style: {
				fontSize:'2vmax'
			}
		},
		subtitle: {
			text: 'Performance By Week',
			style: {
				fontSize:'1.7vmax'
			}
		},
		xAxis: {
			categories: <%= @team1wk  %>,
			title: {
				text: 'Game Weeks',
				style: {
                    fontSize:'1.7vmax',
                }
			}
		},
		yAxis: {
			title: {
				text: 'Performance',
				style: {
                    fontSize:'1.7vmax',
                }
			}
		},
		plotOptions: {
			line: {
				dataLabels: {
					enabled: true,
					borderRadius: 5,
					backgroundColor: '#F0C34D',
					borderWidth: 1,
					borderColor: '#AAA',
					y: -6
				},
				enableMouseTracking: true
			}
		},
        tooltip: {
            formatter: function () {
                var s = '<b>' + this.x + '</b>';
				<% @tt.each do |ttt| %>
                $.each(this.points, function () {
                    s += '<br/>' + '(<%= ttt.gameResult %>)' + this.series.name + ': ' + this.y;
                });
                <% end %>
                return s;
                
            },
            shared: true
        },
		series: [{
			name: '<%= @team1name.first.gsub('"','') %>',
			color: '#dd402e',
			data: <%= @team1gt %>
		}, {
			name: '<%= @team2name.first.gsub('"','') %>',
			color: '#323232',
			data: <%= @team2gt %>
		}]
	});
		$(".transform").change(function() {
			var value = this.getAttribute("value");

			if (value == 'a') 
			{
				chart.series[0].remove();
				chart.series[0].remove();
				chart.setTitle({ 
					text: '<%= @team1name.first.gsub('"','') %> (<%= @team1s2dm.last.round(3) %>) vs <%= @team2name.first.gsub('"','') %> (<%= @team2s2dm.last.round(3) %>)' 
					}, 
					{ 
					text: 'Advantage Value: <%= u = ((@team1s2dm.last) - (@team2s2dm.last)).round(3) %>'
				});
				chart.addSeries({
					name: '<%= @team1name.first.gsub('"','') %>',
					type: 'line',
					color: '#dd402e',  
				    data: <%= @team1gt %>              
				});   
				chart.addSeries({
					name: '<%= @team2name.first.gsub('"','') %>',
					type: 'line',
					color: '#323232',  
				    data: <%= @team2gt %>              
				});  
			}


			else if (value == 'b') 
			{
				chart.series[0].remove();
				chart.series[0].remove();
				chart.setTitle({ 
					text: '<%= @team1name.first.gsub('"','') %> (<%= @team1off.last.round(3) %>) vs <%= @team2name.first.gsub('"','') %> (<%= @team2off.last.round(3) %>)' 
					}, 
					{ 
					text: 'Advantage Value: <%= s = ((@team1off.last) - (@team2off.last)).round(3) %>'
				});
				chart.addSeries({
					name: '<%= @team1name.first.gsub('"','') %>',
					type: 'line',
					color: '#dd402e',  
					data: <%= @team1off %>              
				});   
				chart.addSeries({
					name: '<%= @team2name.first.gsub('"','') %>',
					type: 'line',
					color: '#323232',  
					data: <%= @team2off %>               
				});  
			}

			else if (value == 'c') 
			{
				chart.series[0].remove();
				chart.series[0].remove();
				chart.setTitle({ 
					text: '<%= @team1name.first.gsub('"','') %> (<%= @team1def.last.round(3) %>) vs <%= @team2name.first.gsub('"','') %> (<%= @team2def.last.round(3) %>)' 
					}, 
					{ 
					text: 'Advantage Value: <%= t = ((@team1def.last) - (@team2def.last)).round(3) %>'
				});
				chart.addSeries({
					name: '<%= @team1name.first.gsub('"','') %>',
					type: 'line',
					color: '#dd402e',  
				    data: <%= @team1def %>              
				});   
				chart.addSeries({
					name: '<%= @team2name.first.gsub('"','') %>',
					type: 'line',
					color: '#323232',  
				    data: <%= @team2def %>             
				});  
			}

			else {
			   alert("Error!");   
			}
		});
	});
</script>
